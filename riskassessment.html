<!DOCTYPE html>
<html lang="en">
  <head>
  <title>Risk Assessment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="jquery.mobile-1.3.1.min.css" />
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="jquery-1.7.1.min.js"></script>
  <script src="jquery.mobile-1.3.1.min.js"></script>
  <script src="utility.js" type="text/javascript" ></script>
  <script src="jquery.validate.js"></script>
  <script src="bcra.js" type="text/javascript"> </script>
  <script>
$(document).ready(function() {
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++)
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == 'name')
        {
        //alert(sParameterName[1]);
		var val=sParameterName[1];
		  $('h4').append(val);	  	
	   }
   }
	
	
	  $('#calcform').validate({  
	  rules: {
	  q1:
	  {  
              required: true  
      },
	  q2:
	  {  
              required: true 
      },
	  q3:
	  {  
              required: true  
      },
	  q4:
	  {  
              required: true 
      },
	  q5:
	  {  
              required: true
      },
	  q6:
	  {  
              required: true 
      },
	  q6a:
	  {  
              required: true  
      },
	  q6b:
	  {  
              required: true  
      },
	  q7:
	  {  
              required: true  
      }, 
	  q7a:
	  {  
              required: true  
      } 
	  }
	  
	  });
 //Check cancer history
$('#q1').change(function() {
	 var q1 = document.getElementById("q1").value;
	if(q1 == "1")
	{
		checkHistory()
	}
});
// Check age criteria
$('#q2').change(function() {
	 var q2 = document.getElementById("q2").value;	
	 if(q2 == "34")
	 {
		 checkAge()
	 }	  
});
	  // change val of 6a n 6b
  $('#q6').change(function() { 
	 var q6 = document.getElementById("q6").value;
	   var q6a   = document.getElementById("q6a");
	   var q6b   = document.getElementById("q6b");
	// alert(q6);
	document.getElementById('q6a').options.length = 0;
    document.getElementById('q6b').options.length = 0;
	 if(q6 == '99' || q6 == '0')
	 {		
	  	opt = {		  
		  '3' : 'N/A'
	  };
	  opt2= {		 
		 '3' : 'N/A'
	  };
	   }
	   if(q6 == '1')
	   {
			 opt = {		 
		  '1' : '1',
		  '2' :'>1'		
	  };		
	  opt2= {
		   '99' : 'Unknown',
		  '0' : 'No',
		  '1': 'Yes'
	  };
	 }
	   $("[name='q6a']").append($('<option></option>').val(" "));
	  $.each(opt, function(q6, text) {
		
        $("[name='q6a']").append($('<option></option>').val(q6).html(text));
    });
		  $("[name='q6b']").append($('<option></option>').val(" "));
	$.each(opt2, function(q6, text) {
	
        $("[name='q6b']").append(
            $('<option></option>').val(q6).html(text)
        );
    });
  });  
});


  $(function(){
$('#calculate').live("click",function()
{
	 var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++)
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == 'user_id')
        {
        //alert(sParameterName[1]);
		var id=sParameterName[1];		 
        }
    }
$("#calcform").validate().element("#q1");
$("#calcform").validate().element("#q2");
$("#calcform").validate().element("#q3");
$("#calcform").validate().element("#q4");
$("#calcform").validate().element("#q5");
$("#calcform").validate().element("#q6");
$("#calcform").validate().element("#q6a");
$("#calcform").validate().element("#q6b");
$("#calcform").validate().element("#q7");
$("#calcform").validate().element("#q7a");

var q1 = document.getElementById("q1").value;  
var q2 = document.getElementById("q2").value;
var q3 = document.getElementById("q3").value;
var q4 = document.getElementById("q4").value;
var q5 = document.getElementById("q5").value;
var q6 = document.getElementById("q6").value;
var q6a = document.getElementById("q6a").value;
var q6b = document.getElementById("q6b").value;
var q7 = document.getElementById("q7").value;
var q7a = document.getElementById("q7a").value;	 


//submit questions	 
//  alert(id)		
var val=$("#calcform").validate().form();
if(val==true)
{ 
$.getJSON("http://www.mobiletest.mednl.com/assessment.php?jsoncallback=?&ans1="+q1+"&ans2="+q2+"&ans3="+q3+"&ans4="+q4+"&ans5="+q5+"&ans6="+q6+"&ans6a="+q6a+"&ans6b="+q6b+"&ans7="+q7+"&ans7a="+q7a+"&user_id="+id, function(data){ 
if(data['err']== '1')
   {
	  alert(data['msg']);
   }
else if(data['err']=='2')
{
	  alert(data['msg']);
}
});
}
else
{
	alert("Please fill all inputs");
}
	 
/*alert(q1);
alert(q2);
alert(q3);
alert(q4);
alert(q5);
alert(q6);
alert(q6a);
alert(q6b);
alert(q6b);
alert(q7);
alert(q7a);*/
});
});
$(document).on('pagebeforecreate', 'body', function(){     
    var interval = setInterval(function(){
      $.mobile.loading( "show", {
text: "Loading",
textVisible: true,
theme: "a",
html: ""
});
        clearInterval(interval);
    },1);    
});

$(document).on('pageshow', 'body', function(){  
    var interval = setInterval(function(){
       $.mobile.loading('hide');
        clearInterval(interval);
    },1);      
});
$(document).bind("mobileinit", function () {
$.mobile.defaultPageTransition = 'none';
});

  </script>
  </head>
  <body>
  <div id="riskassessment" data-role="page"  class="data-value">
    <div data-position="fixed" data-role="header" class="ui-header ui-bar-a ui-header-fixed slidedown" role="banner"> <a href="index.html#home" data-icon="home" class="ui-btn-left" rel="external">Home</a>
      <h1 class="ui-title pagetitle" role="heading" aria-level="1">Risk Assessment</h1>
      <h4 class="welcometxt" id="welcometxt"> Welcome </h4>
    </div>
    <div data-role="content">
      <div id="main-content">
        <p>The Breast Cancer Risk Assessment Tool is an interactive tool designed by scientists at the National Cancer Institute (NCI) and the National surgical Adjuvant Breast and Bowel Project (NSABP) to estimate a woman's risk of developing invasive breast cancer.</p>
        <p> To calculate your risk of getting breast cancer, answer the questions in the Risk Calculator below. </p>
        <h5> RISK CALCULATOR </h5>
        <form id="calcform" method="post" action="">
          <label for="q1" class="select">1.Do you have a medical history of any breast cancer or of ductal carcinoma in situ (DCIS) or lobular carcinoma in situ (LCIS)? </label>
          <select name="q1" id="q1">
            <option> </option>
            <option value="1">Yes</option>
            <option value="0">No</option>
          </select>
          <label for="q2" class="select">2.What is your age? </label>
          <select name="q2" id="q2">
            <option> </option>
            <option value="34"> < 35 </option>
            <option value="35">35</option>
            <option value="36">36</option>
            <option value="37">37</option>
            <option value="38">38</option>
            <option value="39">39</option>
            <option value="40">40</option>
            <option value="41">41</option>
            <option value="42">42</option>
            <option value="43">43</option>
            <option value="44">44</option>
            <option value="45">45</option>
            <option value="46">46</option>
            <option value="47">47</option>
            <option value="48">48</option>
            <option value="49">49</option>
            <option value="50">50</option>
            <option value="51">51</option>
            <option value="52">52</option>
            <option value="53">53</option>
            <option value="54">54</option>
            <option value="55">55</option>
            <option value="56">56</option>
            <option value="57">57</option>
            <option value="58">58</option>
            <option value="59">59</option>
            <option value="60">60</option>
            <option value="61">61</option>
            <option value="62">62</option>
            <option value="63">63</option>
            <option value="64">64</option>
            <option value="65">65</option>
            <option value="66">66</option>
            <option value="67">67</option>
            <option value="68">68</option>
            <option value="69">69</option>
            <option value="70">70</option>
            <option value="71">71</option>
            <option value="72">72</option>
            <option value="73">73</option>
            <option value="74">74</option>
            <option value="75">75</option>
            <option value="76">76</option>
            <option value="77">77</option>
            <option value="78">78</option>
            <option value="79">79</option>
            <option value="80">80</option>
            <option value="81">81</option>
            <option value="82">82</option>
            <option value="83">83</option>
            <option value="84">84</option>
            <option value="85">85</option>
          </select>
          <label for="q3" class="select">3.What was your age at the time of your first menstrual period? </label>
          <select name="q3" id="q3">
            <option > </option>
            <option value="99">Unknown</option>
            <option value="10">7-11</option>
            <option value="13">12-13</option>
            <option value="14"> >= 14</option>
          </select>
          <label for="q4" class="select">4.What was your age at the time of the first live birth of your child? </label>
          <select name="q4" id="q4">
            <option> </option>
            <option value="99">Unknown</option>
            <option value="0">No births</option>
            <option value="15">< 20</option>
            <option value="22"> 20-24</option>
            <option value="27"> 25-29</option>
            <option value="30"> >= 30</option>
          </select>
          <label for="q5" class="select">5.How many of your first-degree relatives - mother, sisters, daughters - have had breast cancer?</label>
          <select name="q5" id="q5">
            <option> </option>
            <option value="99">Unknown</option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2"> >1</option>
          </select>
          <label for="q6" class="select">6.Have you ever had a breast biopsy?</label>
          <select name="q6" id="q6">
            <option> </option>
            <option value="99">Unknown</option>
            <option value="0">No</option>
            <option value="1">Yes</option>
          </select>
          <label for="q6a" class="select">6a. How many breast biopsies (positive or negative) have you had?</label>
          <select name="q6a" id="q6a">
            <option> </option>
          </select>
          <label for="q6b" class="select">6b. Have you had at least one breast biopsy with atypical hyperplasia?</label>
          <select name="q6b" id="q6b">
            <option> </option>
          </select>
          <label for="q7" class="select">7. What is your race/ethnicity?</label>
          <select name="q7" id="q7">
            <option> </option>
            <option value="1">White</option>
          </select>
          <label for="q7a" class="select">7a. What is the sub-race/ethnicity</label>
          <select name="q7a" id="q7a">
            <option> </option>
            <option value="7">Chinese</option>
            <option value="8">Japanese</option>
            <option value="9">Filipino</option>
            <option value="10">Hawaiian</option>
            <option value="11">Other Pacific Islander</option>
            <option value="12">Other Asian-American</option>
          </select>
          <div class="calbtn">
            <input type="button" value="Calculate" id="calculate"/>
          </div>
        </form>
      </div>
    </div>
  </div>
</body>
</html>
